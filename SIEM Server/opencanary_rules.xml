<group name="opencanary,">
  
  <!-- Parent grouping rule -->
  <rule id="230000" level="3">
    <decoded_as>opencanary-json</decoded_as>
    <description>OpenCanary messages grouped.</description>
  </rule>

  <!-- Child: CanaryFTP service added -->
  <rule id="230001" level="5">
    <if_sid>230000</if_sid>
    <field name="message">Added service from class CanaryFTP</field>
    <description>OpenCanary: CanaryFTP service added.</description>
  </rule>

  <!-- Child: Generic FTP activity -->
  <rule id="230003" level="6">
    <if_sid>230000</if_sid>
    <field name="message">ftp</field>
    <description>OpenCanary: FTP-related activity detected.</description>
  </rule>

  <rule id="100500" level="10">
    <decoded_as>json</decoded_as>
    <field name="logtype">2000</field>
    <field name="dst_port">21</field>
    <description>OpenCanary FTP login attempt detected</description>
  </rule>

  <rule id="100501" level="10">
    <decoded_as>json</decoded_as>
    <field name="logtype">2000</field>
    <field name="dst_port">445</field>
    <description>OpenCanary SMB login attempt detected</description>
  </rule>
  
  <rule id="100502" level="10">
    <decoded_as>json</decoded_as>
    <field name="logtype">2000</field>
    <field name="dst_port">3306</field>
    <description>OpenCanary MySQL login attempt detected</description>
  </rule>

</group>